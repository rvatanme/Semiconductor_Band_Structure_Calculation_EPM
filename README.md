# Electronic Band Structure Calculation
Electronic band structure of a solid provides a set of possible energies that an electron might have with a wavevector of k in that solid. The variety of methods including Emprical Psuedopotential Methods (EPM), k.p perturbation theory, tight binding model, density functional theory, Green's function, etc have been proposed for band structure calculation. Among the many methods available, the EPM method, due to its short calculation runtime, has provided invaluable and practical tool in the design and modelling of modern electronic devices and semiconductor nanostrucre. Here three scripts written in C,C++ and python based on EPM model are provided that calculte the electronic band structure of a solid in diamond or zincblend crystal structure. 

## EPM Method
Consider a collection of noninteracting electrons in a box with L<sub>x</sub>,L<sub>y</sub>,L<sub>z</sub>, then the solution to the time independent Schroedinger’s equation in a priodic framework (ψ(x+L<sub>x</sub>, y+L<sub>y</sub>, z+L<sub>z</sub>) = ψ(x,y,z)) is:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20-%5Cfrac%7B%5Chbar%5E2%7D%7B2m%7D%5Ctriangledown%5E2%5Cpsi%20_n%3D%20%5Cepsilon%20_n%5Cpsi%20_n%20%5C%3B%5C%3B%20%5Crightarrow%20%5C%3B%5C%3B%20%5Cpsi%20_n%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7BV%7D%7De%5E%7Bik_xx%7De%5E%7Bik_yy%7De%5E%7Bik_zz%7D)

where V is the volume of the box and n is any set of whole numbers (n<sub>x</sub>, n<sub>y</sub>, n<sub>z</sub>). The exp(ik<sub>x</sub>x) describes an electron traveling along x axis with the average momentum of ћk<sub>x</sub> where k<sub>x</sub> is a real number 2n<sub>x</sub>π/L<sub>x</sub>. Defining r=xi+yj+zk and k=k<sub>x</sub>i+k<sub>y</sub>j+k<sub>z</sub>k, then ψ<sub>k</sub>(r) describes a free electron moving along r direction:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5Cpsi%20_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7BV%7D%7De%5E%7Bi%5Cvec%7Bk%7D.%5Cvec%7Br%7D%7D%20%5C%3B%5C%3B%5Crightarrow%20%5C%3B%5C%3BE_k%3D%5Cfrac%7B%5Chbar%20%5E2k%5E2%7D%7B2m%7D)

Noting the symmetry of ψ<sub>k</sub>(r), the probability density of an electron with any k wavevector is uniform in the space. Following the same procedure, the solution to the time dependent Schroedinger’s equation of free electron is:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20-%5Cfrac%7B%5Chbar%5E2%7D%7B2m%7D%5Ctriangledown%5E2%5Cpsi%20%28%5Cvec%7Br%7D%2Ct%29%3D%20i%5Chbar%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D%5Cpsi%20%28%5Cvec%7Br%7D%2Ct%29%20%5C%5C%20%5C%5C%20%5Cpsi%20_k%28%5Cvec%7Br%7D%2Ct%29%3DAe%5E%7Bi%28%5Cvec%7Bk%7D.%5Cvec%7Br%7D-%5Comega%20t%29%7D%20%3D%20Ae%5E%7Bi%28%5Cvec%7Bp%7D.%5Cvec%7Br%7D-E%20t%29/%5Chbar%7D%20%5C%5C%20%5C%5C%20%5Cvec%7Bp%7D%3D%5Chbar%20%5Cvec%7Bk%7D%20%5C%3B%5C%3B%5C%3B%5C%3B%20E%20%3D%20%5Chbar%20%5Comega)

Now let's imagine a collection of atoms or cores (Coulomb potetial centers) are added to the mentioned box with the periodicity of the Bravais lattice. A Bravais lattice is an infinite array of discrete points generated by a set of discrete translation operations described in 3D space by **R** = n<sub>1</sub>**a<sub>1</sub>** + n<sub>2</sub>**a<sub>2</sub>** + n<sub>2</sub>**a<sub>2</sub>**, where n<sub>1</sub>, n<sub>2</sub>, and n<sub>3</sub> are integer numbers and **a<sub>1</sub>**, **a<sub>2</sub>**, **a<sub>3</sub>** are basis vectors.

The electrons in a crystal (basis + lattice) exprience a potential with the same priodicity as the crystal priodicity which means that V(**r+R**)=V(**r**). According to Bloch's theorem, the one electron Schroedinger’s equation for a periodic potential has the form of:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5Cpsi%20_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29%3De%5E%7Bi%5Cvec%7Bk%7D.%5Cvec%7Br%7D%7Du_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%20u_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D&plus;%5Cvec%7BR%7D%29%3Du_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29)

Since u<sub>k</sub>(r) and V(r) function have the priodicity of the crystal, they can be both expanded as a Fourier sum of M reciprocal plane waves: 

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20u_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29%3D%5Csum_%7Bm%3D0%7D%5E%7BM%7Da_m%28%5Cvec%7Bk%7D%29e%5E%7Bi%5Cvec%7BG_m%7D.%5Cvec%7Br%7D%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%20V%28%5Cvec%7Br%7D%29%20%3D%20%5Csum_%7Bm%3D0%7D%5E%7BM%7DV%28%7C%5Cvec%7BG_m%7D%7C%29e%5E%7Bi%5Cvec%7BG_m%7D.%5Cvec%7Br%7D%7D)

G presents the reciprocal lattice vectors where:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20e%5E%7B-i%5Cvec%7BG%7D.%5Cvec%7BR%7D%7D%20%3D%201%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%20%5Cvec%7BG%7D.%5Cvec%7BR%7D%3D2%5Cpi%20n%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%20n%3D%5Csum_%7Bi%3D1%7D%5E%7B3%7Dn_im_i)

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5Cvec%7BR%7D%20%3D%20n_1%5Cvec%7Ba_1%7D&plus;n_2%5Cvec%7Ba_2%7D&plus;n_3%5Cvec%7Ba_3%7D%5C%5C%5C%5C%20%5Cvec%7BG%7D%20%3D%20m_1%5Cvec%7Bb_1%7D&plus;m_2%5Cvec%7Bb_2%7D&plus;m_3%20%5Cvec%7Bb_3%7D%2C%20%5C%3B%5C%3B%5C%3B%20a_i.b_j%3D2%5Cpi%20%5Cdelta%20_%7Bi%2Cj%7D)

Here, since V(r) only depends on the magnitude of G<sub>m</sub>, the pseudo-potential is called local pseudo-potential otherwise it is called non-local pseudo-potential. Therefor for a given k, the pseudo-wavefunction is expressed as follows:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5Cpsi_%7B%5Cvec%7Bk%7D%7D%28%5Cvec%7Br%7D%29%3D%5Csum_%7Bm%3D0%7D%5E%7BM%7Da_m%28%5Cvec%7Bk%7D%29e%5E%7Bi%28%5Cvec%7BG_m%7D&plus;%5Cvec%7Bk%7D%29.%5Cvec%7Br%7D%7D)

By substituting pseudo-function and Fourier transformed potential in the Schroedinger equation, the matrix form of eigenvalue and eignvalue problem results in:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5B%5Cfrac%7B%5Chbar%20%5E2%28%5Cvec%7Bk%7D&plus;%5Cvec%7BG_m%7D%29%5E2%7D%7B2m%7D-E%5Da_m%28%5Cvec%7Bk%7D%29&plus;%5C%5C%5C%5C%5Csum_%7Bn%5Cneq%20m%7DV%28%7C%5Cvec%7BG_m%7D-%5Cvec%7BG_n%7D%7C%29a_n%28%5Cvec%7Bk%7D%29%3D0)

Depending on the number (N) of chosen reciprocal plane waves, above equation has N solution that each of them presents the E<sub>nk</sub> and results to a<sub>m</sub>(n,k) and Ψ<sub>nk</sub>(r). The number of used reciprocal plane waves are determined by the cutoff energy where the energy of those plane waves are less than Ecutoff ћ<sup>2</sup>G<sup>2</sup>/2m<Ecutoff. |G<sup>2</sup>| is usually expressed in terms of (2π/a)<sup>2</sup> where a is the lattice constant. Since for every k, there are a number of equivalent (k+G)’s, where Ψ<sub>k+G</sub>(r)=Ψ<sub>k</sub>(r) and E(k+G)=E(k), the unique values of k are the ones inside the first Brillouin zone.  

## Periodic Potential: Reciprocal Space Expression 
In general, periodic potential V<sub>p</sub>(r) is a linear combination of atomic potential, V<sub>n</sub>(r-τ<sub>n</sub>), that can be expressed as a summation over all lattice translational R vectors: 

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_p%28%5Cvec%7Br%7D%29%3D%5Csum_%7BR%7D%20%5Csum_%7Bn%3D1%7D%5E%7BN%7DV_n%28%5Cvec%7Br%7D%20-%20%5Cvec%7B%5Ctau%20_n%7D%20-%5Cvec%7BR%7D%29)

where r is the position of electron and τ<sub>n</sub> is the location of nth atom, both inside the unit cell. The inner sum of this equation can be substituted by the unit cell potential defined as follows:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_0%28%5Cvec%7Br%7D%29%20%3D%20%5Csum_%7Bn%3D1%7D%5E%7BN%7D%20V_n%28%5Cvec%7Br%7D-%5Ctau%20_n%29%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%281%29)

After substitution, the final form of periodic potential in real space results in:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_p%28%5Cvec%7Br%7D%29%20%3D%20%5Csum_%7BG%7DV_0%28%5Cvec%7BG%7D%29e%5E%7Bi%5Cvec%7BG%7D.%5Cvec%7Br%7D%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%282%29)

As mentioned before, this periodic potential can be expanded by a set of chosen reciprocal plane waves:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_p%28%5Cvec%7Br%7D%29%20%3D%20%5Csum_%7BG%7DV_0%28%5Cvec%7BG%7D%29e%5E%7Bi%5Cvec%7BG%7D.%5Cvec%7Br%7D%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%283%29%20%5C%5C%5C%5C%5C%5C%20V_0%28%5Cvec%7BG%7D%29%20%3D%20%5Cfrac%7B1%7D%7B%5COmega%7D%5Cint_%7B%5COmega%7Dd%5E3rV_0%28%5Cvec%7Br%7D%29e%5E%7B-i%5Cvec%7BG%7D.%5Cvec%7Br%7D%7D%5C%3B%5C%3B%5C%3B%5C%3B%20%284%29)

where Ω is the unit cell volume and V<sub>0</sub>(G) is the unit cell potential expressed in reciprocal lattice. By substituing equation (1) in equation (4), we get the unit cell potential as a sum of atomic potential in G space:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_0%28%5Cvec%7BG%7D%29%20%3D%5Cfrac%7B1%7D%7BN%7D%20%5Csum_%7Bn%3D1%7D%5E%7BN%7DV_n%28%5Cvec%7BG%7D%29e%5E%7B-i%5Cvec%7BG%7D.%5Cvec%7B%5Ctau%20_n%7D%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%285%29)

By defining structural factor as:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20S_n%28%5Cvec%7BG%7D%29%3D%5Cfrac%7B1%7D%7BN%7De%5E%7B-i%5Cvec%7BG%7D.%5Cvec%7B%5Ctau%20_n%7D%7D%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%286%29)

The final form of unit cell potential in G space is:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_0%28%5Cvec%7BG%7D%29%3D%5Csum_%7Bn%3D1%7D%5E%7BN%7DS_n%28%5Cvec%7BG%7D%29V_n%28%5Cvec%7BG%7D%29%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%287%29)

In the case of a solid with zincblende or diamond lattice structure, if the origin is taken half way between the two atoms in the unit cell, the τ<sub>1</sub>=-τ and τ<sub>2</sub>=τ, where τ is τ=a<sub>0</sub>(1/8, 1/8, 1/8), V<sub>0</sub>(G) can be expressed as a combination of symmetric and asymmetric potential as follows:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20V_0%28%5Cvec%7BG%7D%29%3D%20V_S%28%5Cvec%7BG%7D%29cos%28%5Cvec%7BG%7D.%5Cvec%7B%5Ctau%7D%29&plus;iV_Asin%28%5Cvec%7BG%7D.%5Cvec%7B%5Ctau%7D%29%2C%20%5C%5C%5C%5C%20V_S%28%5Cvec%7BG%7D%29%3D%5Cfrac%7B1%7D%7B2%7D%5BV_1%28%5Cvec%7BG%7D%29&plus;V_2%28%5Cvec%7BG%7D%29%5D%2C%20%5C%5C%5C%5C%20V_A%28%5Cvec%7BG%7D%29%3D%5Cfrac%7B1%7D%7B2%7D%5BV_1%28%5Cvec%7BG%7D%29-V_2%28%5Cvec%7BG%7D%29%5D)

These symmetric and asymmetric pseudo-potential is provided as inputs of EMP calculations. In EPM, they are measured experimentally. 

## Pseudo-Potential Concept
The pseudopotential is an attempt to replace the complicated effects of the motion of the core (i.e. non-valence) electrons of an atom and its nucleus with an effective potential, or pseudopotential, so that the Schrödinger equation contains a modified effective potential term instead of the Coulombic potential term for core electrons normally found in the Schrödinger equation.

The pseudopotential is an effective potential constructed to replace the atomic all-electron potential (full-potential) such that core states are eliminated and the valence electrons are described by pseudo-wavefunctions with significantly fewer nodes. This allows the pseudo-wavefunctions to be described with far fewer Fourier modes, thus making plane-wave basis sets practical to use. In this approach usually only the chemically active valence electrons are dealt with explicitly, while the core electrons are 'frozen', being considered together with the nuclei as rigid non-polarizable ion cores. It is possible to self-consistently update the pseudopotential with the chemical environment that it is embedded in, having the effect of relaxing the frozen core approximation, although this is rarely done. In codes using local basis functions, like Gaussian, often effective core potentials are used that only freeze the core electrons.

First-principles pseudopotentials are derived from an atomic reference state, requiring that the pseudo- and all-electron valence eigenstates have the same energies and amplitude (and thus density) outside a chosen core cut-off radius r<sub>c</sub>.

Pseudopotentials with larger cut-off radius are said to be softer, that is more rapidly convergent, but at the same time less transferable, that is less accurate to reproduce realistic features in different environments.

Motivation:

    Reduction of basis set size
    Reduction of number of electrons
    Inclusion of relativistic and other effects

Approximations:

    One-electron picture.
    The small-core approximation assumes that there is no significant overlap between core and valence wave-function. Nonlinear core corrections[2] or "semicore" electron inclusion[3] deal with situations where overlap is non-negligible.

The concept of pseudopotentials was introduced by Fermi to study high-lying atomic states. Afterwards, Hellman proposed that pseudopotentials be used for calculating the energy levels of the alkali metals. The wide spread usage of pseudopotentials did not occur until the late 1950s, when activity in the area of condensed matter physics began to accelerate. The main advantage of using pseudopotentials is that only valence electrons have to be considered. The core electrons are treated as if they are frozen in an atomic-like configuration. As a result, the valence electrons are thought to move in a weak one-electron potential.

The pseudopotential method is based on the orthogonalized plane wave (OPW) method. In this method, the crystal wavefuntion Ψ<sub>k</sub> is constructed to be orthogonal to the core states. This is accomplished by expanding Ψ<sub>k</sub> as a smooth part of symmetrized combinations of Bloch functions ψ<sub>k</sub>, augmented with a linear combination of core states. This is expressed as:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5CPsi_k%20%3D%20%5Cpsi_k%20&plus;%20%5Csum_%7Bt%7Db_%7Bk%2Ct%7D%5Cphi_t%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%288%29)

where b<sub>k,t</sub> are orthogonalization coefficients and φ<sub>k</sub> are core wave functions. For Si-14, the summation over t in equation (8) is a sum over the core states 1s2 2s2 2p6. Since the crystal wave function Ψ<sub>k</sub> is constructed to be orthogonal to the core wave functions, the orthogonalization coefficients can be calculated, thus yielding the final expression:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20%5CPsi_k%20%3D%20%5Cpsi_k%20&plus;%20%5Csum_%7Bt%7D%3C%5Cphi_t%7C%5Cpsi_k%3E%5Cphi_t%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%289%29)

To obtain a wave equation for ψ<sub>k</sub>, the Hamiltonian operator:

![](https://latex.codecogs.com/svg.latex?%5Cdpi%7B300%7D%20%5CLARGE%20H%20%3D%20%5Cfrac%7Bp%5E2%7D%7B2m%7D&plus;V_C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%2810%29)

is applied to equation (8), where V<sub>C</sub> is the attractive core potential, and the following wave equation results:

![]()
